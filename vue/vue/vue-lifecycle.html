<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>生命周期 | 花帽子的博客</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/blog/logo.png">
    <link rel="manifest" href="/blog/manifest.json">
    <link rel="apple-touch-icon" href="/blog/images/icons/apple-icon-152x152.png">
    <meta name="description" content="我命由我不由天，学习吧少年">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/blog/assets/css/0.styles.c05398d7.css" as="style"><link rel="preload" href="/blog/assets/js/app.faba343f.js" as="script"><link rel="preload" href="/blog/assets/js/2.55125c9d.js" as="script"><link rel="preload" href="/blog/assets/js/103.737ddbdf.js" as="script"><link rel="preload" href="/blog/assets/js/4.f8e09ced.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.d39b695f.js"><link rel="prefetch" href="/blog/assets/js/100.6a21f57c.js"><link rel="prefetch" href="/blog/assets/js/101.109d4bf7.js"><link rel="prefetch" href="/blog/assets/js/102.145cf5fb.js"><link rel="prefetch" href="/blog/assets/js/104.41472c40.js"><link rel="prefetch" href="/blog/assets/js/105.2c84942f.js"><link rel="prefetch" href="/blog/assets/js/106.dac155f4.js"><link rel="prefetch" href="/blog/assets/js/107.f403aecb.js"><link rel="prefetch" href="/blog/assets/js/108.def2fb4e.js"><link rel="prefetch" href="/blog/assets/js/109.38386af1.js"><link rel="prefetch" href="/blog/assets/js/11.c67ac9c5.js"><link rel="prefetch" href="/blog/assets/js/110.e1060bae.js"><link rel="prefetch" href="/blog/assets/js/111.0fa013ee.js"><link rel="prefetch" href="/blog/assets/js/112.f5353fc6.js"><link rel="prefetch" href="/blog/assets/js/113.772575f3.js"><link rel="prefetch" href="/blog/assets/js/114.0badcc8e.js"><link rel="prefetch" href="/blog/assets/js/115.2426db98.js"><link rel="prefetch" href="/blog/assets/js/116.c54a2da7.js"><link rel="prefetch" href="/blog/assets/js/117.84c280ea.js"><link rel="prefetch" href="/blog/assets/js/118.420dd854.js"><link rel="prefetch" href="/blog/assets/js/12.cb725f93.js"><link rel="prefetch" href="/blog/assets/js/13.46dfc8b8.js"><link rel="prefetch" href="/blog/assets/js/14.edfa841d.js"><link rel="prefetch" href="/blog/assets/js/15.4a9919ce.js"><link rel="prefetch" href="/blog/assets/js/16.1f40968b.js"><link rel="prefetch" href="/blog/assets/js/17.4106a270.js"><link rel="prefetch" href="/blog/assets/js/18.26829f37.js"><link rel="prefetch" href="/blog/assets/js/19.1119d260.js"><link rel="prefetch" href="/blog/assets/js/20.a558432d.js"><link rel="prefetch" href="/blog/assets/js/21.22d5e68d.js"><link rel="prefetch" href="/blog/assets/js/22.63651469.js"><link rel="prefetch" href="/blog/assets/js/23.5fba09f6.js"><link rel="prefetch" href="/blog/assets/js/24.98aece5a.js"><link rel="prefetch" href="/blog/assets/js/25.5f53b609.js"><link rel="prefetch" href="/blog/assets/js/26.a4bf8e23.js"><link rel="prefetch" href="/blog/assets/js/27.de5a7d2d.js"><link rel="prefetch" href="/blog/assets/js/28.8a9b59a8.js"><link rel="prefetch" href="/blog/assets/js/29.eedf6cf6.js"><link rel="prefetch" href="/blog/assets/js/3.6b7316b6.js"><link rel="prefetch" href="/blog/assets/js/30.dd034a0e.js"><link rel="prefetch" href="/blog/assets/js/31.3b9328e6.js"><link rel="prefetch" href="/blog/assets/js/32.f7d51c4d.js"><link rel="prefetch" href="/blog/assets/js/33.d4cbb362.js"><link rel="prefetch" href="/blog/assets/js/34.a9052e33.js"><link rel="prefetch" href="/blog/assets/js/35.3124928b.js"><link rel="prefetch" href="/blog/assets/js/36.be478d14.js"><link rel="prefetch" href="/blog/assets/js/37.8f192772.js"><link rel="prefetch" href="/blog/assets/js/38.5d4cc67e.js"><link rel="prefetch" href="/blog/assets/js/39.26825c5c.js"><link rel="prefetch" href="/blog/assets/js/40.4301e204.js"><link rel="prefetch" href="/blog/assets/js/41.2c75cd7e.js"><link rel="prefetch" href="/blog/assets/js/42.3d94fe78.js"><link rel="prefetch" href="/blog/assets/js/43.d958fef9.js"><link rel="prefetch" href="/blog/assets/js/44.ccba277e.js"><link rel="prefetch" href="/blog/assets/js/45.4f0a6c55.js"><link rel="prefetch" href="/blog/assets/js/46.ca30c5b3.js"><link rel="prefetch" href="/blog/assets/js/47.4cdab66c.js"><link rel="prefetch" href="/blog/assets/js/48.4726e403.js"><link rel="prefetch" href="/blog/assets/js/49.9172fa64.js"><link rel="prefetch" href="/blog/assets/js/5.402dcc31.js"><link rel="prefetch" href="/blog/assets/js/50.5f19c636.js"><link rel="prefetch" href="/blog/assets/js/51.5ff6cba2.js"><link rel="prefetch" href="/blog/assets/js/52.7ef8e381.js"><link rel="prefetch" href="/blog/assets/js/53.95eb8dc5.js"><link rel="prefetch" href="/blog/assets/js/54.49de9019.js"><link rel="prefetch" href="/blog/assets/js/55.30caa188.js"><link rel="prefetch" href="/blog/assets/js/56.f114a02e.js"><link rel="prefetch" href="/blog/assets/js/57.822f9e0e.js"><link rel="prefetch" href="/blog/assets/js/58.4ea9e214.js"><link rel="prefetch" href="/blog/assets/js/59.4872855e.js"><link rel="prefetch" href="/blog/assets/js/6.6628c9dd.js"><link rel="prefetch" href="/blog/assets/js/60.f876b79e.js"><link rel="prefetch" href="/blog/assets/js/61.b1a03c6c.js"><link rel="prefetch" href="/blog/assets/js/62.13763602.js"><link rel="prefetch" href="/blog/assets/js/63.d269a4f5.js"><link rel="prefetch" href="/blog/assets/js/64.dda36bb2.js"><link rel="prefetch" href="/blog/assets/js/65.11c6c02a.js"><link rel="prefetch" href="/blog/assets/js/66.98877f57.js"><link rel="prefetch" href="/blog/assets/js/67.cc9b5aef.js"><link rel="prefetch" href="/blog/assets/js/68.a77e8f1e.js"><link rel="prefetch" href="/blog/assets/js/69.f30e4059.js"><link rel="prefetch" href="/blog/assets/js/7.1bbe8422.js"><link rel="prefetch" href="/blog/assets/js/70.fdc5968b.js"><link rel="prefetch" href="/blog/assets/js/71.c3bb19dd.js"><link rel="prefetch" href="/blog/assets/js/72.dfbc86d4.js"><link rel="prefetch" href="/blog/assets/js/73.81402f0e.js"><link rel="prefetch" href="/blog/assets/js/74.6d06d057.js"><link rel="prefetch" href="/blog/assets/js/75.9a6895ed.js"><link rel="prefetch" href="/blog/assets/js/76.a5ca1715.js"><link rel="prefetch" href="/blog/assets/js/77.7f6f3043.js"><link rel="prefetch" href="/blog/assets/js/78.73659ff6.js"><link rel="prefetch" href="/blog/assets/js/79.80775986.js"><link rel="prefetch" href="/blog/assets/js/8.441834aa.js"><link rel="prefetch" href="/blog/assets/js/80.d47bb923.js"><link rel="prefetch" href="/blog/assets/js/81.3fd74af3.js"><link rel="prefetch" href="/blog/assets/js/82.4a77c9fa.js"><link rel="prefetch" href="/blog/assets/js/83.049d8a09.js"><link rel="prefetch" href="/blog/assets/js/84.42141398.js"><link rel="prefetch" href="/blog/assets/js/85.5522d44e.js"><link rel="prefetch" href="/blog/assets/js/86.ac1eb3e4.js"><link rel="prefetch" href="/blog/assets/js/87.dc49add2.js"><link rel="prefetch" href="/blog/assets/js/88.1f060502.js"><link rel="prefetch" href="/blog/assets/js/89.d187ba21.js"><link rel="prefetch" href="/blog/assets/js/9.a921bf18.js"><link rel="prefetch" href="/blog/assets/js/90.6f2482d6.js"><link rel="prefetch" href="/blog/assets/js/91.b702e222.js"><link rel="prefetch" href="/blog/assets/js/92.d2e7a694.js"><link rel="prefetch" href="/blog/assets/js/93.3e08dfef.js"><link rel="prefetch" href="/blog/assets/js/94.c2fa8a82.js"><link rel="prefetch" href="/blog/assets/js/95.21fba37a.js"><link rel="prefetch" href="/blog/assets/js/96.defe38ae.js"><link rel="prefetch" href="/blog/assets/js/97.c640b31f.js"><link rel="prefetch" href="/blog/assets/js/98.93405fb5.js"><link rel="prefetch" href="/blog/assets/js/99.97791985.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.c05398d7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/logo.png" alt="花帽子的博客" class="logo"> <span class="site-name can-hide">花帽子的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/vue/" class="nav-link router-link-active">
  Vue
</a></div><div class="nav-item"><a href="/blog/css/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/blog/javascript/" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/blog/typescript/" class="nav-link">
  TS
</a></div><div class="nav-item"><a href="/blog/node/" class="nav-link">
  Node
</a></div><div class="nav-item"><a href="/blog/optimization/" class="nav-link">
  优化
</a></div><div class="nav-item"><a href="/blog/mobile/" class="nav-link">
  移动端
</a></div><div class="nav-item"><a href="/blog/talk/" class="nav-link">
  其他
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/jonny-wei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub地址
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/vue/" class="nav-link router-link-active">
  Vue
</a></div><div class="nav-item"><a href="/blog/css/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/blog/javascript/" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/blog/typescript/" class="nav-link">
  TS
</a></div><div class="nav-item"><a href="/blog/node/" class="nav-link">
  Node
</a></div><div class="nav-item"><a href="/blog/optimization/" class="nav-link">
  优化
</a></div><div class="nav-item"><a href="/blog/mobile/" class="nav-link">
  移动端
</a></div><div class="nav-item"><a href="/blog/talk/" class="nav-link">
  其他
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/jonny-wei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub地址
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue秘籍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/" aria-current="page" class="sidebar-link">Vue 的秘籍</a></li><li><a href="/blog/vue/interview/vue-communication.html" class="sidebar-link">Vue 组件通信</a></li><li><a href="/blog/vue/interview/vue-symbols.html" class="sidebar-link">Vue 修饰符</a></li><li><a href="/blog/vue/interview/vue-test.html" class="sidebar-link">Vue 单元测试</a></li><li><a href="/blog/vue/interview/vue-router.html" class="sidebar-link">Vue 路由原理</a></li><li><a href="/blog/vue/interview/vue-vuex.html" class="sidebar-link">Vuex 实现原理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Vue源码解析</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/vue/github.html" class="sidebar-link">源码学习</a></li><li><a href="/blog/vue/vue/vue-render.html" class="sidebar-link">渲染器</a></li><li><a href="/blog/vue/vue/vue-init.html" class="sidebar-link">构建与初始化</a></li><li><a href="/blog/vue/vue/vue-observer.html" class="sidebar-link">响应式原理</a></li><li><a href="/blog/vue/vue/vue-template.html" class="sidebar-link">模板编译与渲染</a></li><li><a href="/blog/vue/vue/vue-diff.html" class="sidebar-link">虚拟 DOM 与 Diff 算法</a></li><li><a href="/blog/vue/vue/vue-nextTick.html" class="sidebar-link">异步更新队列</a></li><li><a href="/blog/vue/vue/vue-lifecycle.html" aria-current="page" class="active sidebar-link">生命周期</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/vue/vue-lifecycle.html#生命周期钩子" class="sidebar-link">生命周期钩子</a></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/vue-lifecycle.html#问题" class="sidebar-link">问题</a></li></ul></li><li><a href="/blog/vue/vue/vue-computed.html" class="sidebar-link">计算属性与侦听器</a></li><li><a href="/blog/vue/vue/vue-slot.html" class="sidebar-link">插槽</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>VueRouter源码解析</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/vue-router/abstract.html" class="sidebar-link">摘要</a></li><li><a href="/blog/vue/vue-router/warmUp.html" class="sidebar-link">准备工作</a></li><li><a href="/blog/vue/vue-router/plugin.html" class="sidebar-link">插件机制</a></li><li><a href="/blog/vue/vue-router/initialization.html" class="sidebar-link">初始化与降级处理</a></li><li><a href="/blog/vue/vue-router/transitions.html" class="sidebar-link">路由过渡与视图渲染</a></li><li><a href="/blog/vue/vue-router/match.html" class="sidebar-link">路由匹配</a></li><li><a href="/blog/vue/vue-router/scroll.html" class="sidebar-link">滚动行为处理</a></li><li><a href="/blog/vue/vue-router/summary.html" class="sidebar-link">总结</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vuex源码解析</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/vuex/abstract.html" class="sidebar-link">摘要</a></li><li><a href="/blog/vue/vuex/warmUp.html" class="sidebar-link">准备工作</a></li><li><a href="/blog/vue/vuex/initialization.html" class="sidebar-link">初始化与模块安装</a></li><li><a href="/blog/vue/vuex/state.html" class="sidebar-link">State 相关</a></li><li><a href="/blog/vue/vuex/getters.html" class="sidebar-link">Getters 相关</a></li><li><a href="/blog/vue/vuex/mutations.html" class="sidebar-link">Mutations 相关</a></li><li><a href="/blog/vue/vuex/actions.html" class="sidebar-link">Actions 相关</a></li><li><a href="/blog/vue/vuex/modules.html" class="sidebar-link">Modules 相关</a></li><li><a href="/blog/vue/vuex/others.html" class="sidebar-link">其他</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue3新特性</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/vue3.x/abstract.html" class="sidebar-link">摘要</a></li><li><a href="/blog/vue/vue3.x/reactivity.html" class="sidebar-link">响应式系统</a></li><li><a href="/blog/vue/vue3.x/features.html" class="sidebar-link">功能方面</a></li><li><a href="/blog/vue/vue3.x/performance.html" class="sidebar-link">性能方面</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h1> <p>每个 Vue 实例在被创建时都要经过一系列的初始化过程——例如，需要设置数据监听、编译模板、将实例挂载到 DOM 并在数据变化时更新 DOM 等。同时在这个过程中也会运行一些叫做生命周期钩子的函数，这给了用户在不同阶段添加自己的代码的机会。生命周期并非指 Vue 中的生命周期钩子，而是指 Vue 内部从初始化到挂载 DOM 的完整流程。从<code>开始创建、初始化数据、编译模版、挂载 Dom -&gt; 渲染、更新 -&gt; 渲染、卸载</code>等一系列过程，我们称这是 Vue 的生命周期。</p> <p><img src="/blog/images/vue/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%BF%87%E7%A8%8B.png" alt="生命周期过程"></p> <h2 id="生命周期钩子"><a href="#生命周期钩子" class="header-anchor">#</a> 生命周期钩子</h2> <p><img src="/blog/images/vue/vue%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90.png" alt="生命周期钩子"></p> <p>Vue实例的生命周期大致可分为4个阶段：</p> <ul><li>初始化阶段：为 Vue 实例上初始化一些属性，事件以及响应式数据；</li> <li>模板编译阶段：将模板编译成渲染函数；</li> <li>挂载阶段：将实例挂载到指定的 DOM 上，即将模板渲染到真实 DOM 中；</li> <li>销毁阶段：将实例自身从父组件中删除，并取消依赖追踪及事件监听器；</li></ul> <table><thead><tr><th style="text-align:left;">生命周期</th> <th style="text-align:left;">描述</th> <th style="text-align:left;">最佳实践</th></tr></thead> <tbody><tr><td style="text-align:left;">beforeCreate</td> <td style="text-align:left;">组件实例被创建之初，组件的属性生效之前。在实例初始化之后，数据观测 (data observer) 和 event/watcher 事件配置之前被调用</td> <td style="text-align:left;">常用于初始化非响应式变量</td></tr> <tr><td style="text-align:left;">created</td> <td style="text-align:left;">组件实例已经完全创建，实例已完成以下的配置：数据观测 (data observer)，属性绑定和方法的运算，watch/event 事件回调，但真实 dom 还没有生成，$el 还不可用</td> <td style="text-align:left;">常用于简单的 AJAX 请求，页面的初始化</td></tr> <tr><td style="text-align:left;">beforeMount</td> <td style="text-align:left;">在挂载开始之前被调用，相关的 render 函数首次被调用</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">mounted</td> <td style="text-align:left;">el 被新创建的 <code>vm.$el</code> 替换，并挂载到实例上去之后调用该钩子。注意 mounted 不会保证所有的子组件也都一起被挂载。如果你希望等到整个视图都渲染完毕，可以在 mounted 内部使用 <code>vm.$nextTick</code>, 该钩子在服务器端渲染期间不被调用。</td> <td style="text-align:left;">常用于获取 VNode 信息和操作，AJAX 请求</td></tr> <tr><td style="text-align:left;">beforeUpdate</td> <td style="text-align:left;">数据更新时调用，发生在虚拟 DOM 打补丁之前。这里适合在更新之前访问现有的 DOM，比如手动移除已添加的事件监听器。该钩子在服务器端渲染期间不被调用，因为只有初次渲染会在服务端进行。</td> <td style="text-align:left;">适合在更新之前访问现有的 DOM，比如手动移除已添加的事件监听器</td></tr> <tr><td style="text-align:left;">update</td> <td style="text-align:left;">组件数据更新之后。由于数据更改导致的虚拟 DOM 重新渲染和打补丁，在这之后会调用该钩子。当这个钩子被调用时，组件 DOM 已经更新，所以你现在可以执行依赖于 DOM 的操作。然而在大多数情况下，你应该避免在此期间更改状态。如果要相应状态改变，通常最好使用计算属性或 watcher 取而代之。注意 updated 不会保证所有的子组件也都一起被重绘。如果你希望等到整个视图都重绘完毕，可以在 updated 里使用 <code>vm.$nextTick</code>。该钩子在服务器端渲染期间不被调用。</td> <td style="text-align:left;">避免在这个钩子函数中操作数据，可能陷入死循环</td></tr> <tr><td style="text-align:left;">activited</td> <td style="text-align:left;">keep-alive 专属，组件被激活时调用。该钩子在服务器端渲染期间不被调用。</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">deactivated</td> <td style="text-align:left;">keep-alive 专属，组件被销毁时调用。该钩子在服务器端渲染期间不被调用。</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">beforeDestory</td> <td style="text-align:left;">实例销毁之前调用。在这一步，实例仍然完全可用。该钩子在服务器端渲染期间不被调用。</td> <td style="text-align:left;">常用于销毁定时器、解绑全局事件、销毁插件对象等操作</td></tr> <tr><td style="text-align:left;">destoryed</td> <td style="text-align:left;">实例销毁后调用。该钩子被调用后，对应 Vue 实例的所有指令都被解绑，所有的事件监听器被移除，所有的子实例也都被销毁。该钩子在服务器端渲染期间不被调用。</td> <td style="text-align:left;"></td></tr></tbody></table> <h3 id="errorcaptured"><a href="#errorcaptured" class="header-anchor">#</a> errorCaptured</h3> <p>errorCaptured (err: Error, vm: Component, info: string) =&gt; ?boolean</p> <p>当捕获一个来自子孙组件的错误时被调用。此钩子会收到三个参数：错误对象、发生错误的组件实例以及一个包含错误来源信息的字符串。此钩子可以返回 false 以阻止该错误继续向上传播。你可以在此钩子中修改组件的状态。因此在捕获错误时，在模板或渲染函数中有一个条件判断来绕过其它内容就很重要；不然该组件可能会进入一个无限的渲染循环。</p> <p>错误传播规则:</p> <ul><li><p>默认情况下，如果全局的 config.errorHandler 被定义，所有的错误仍会发送它，因此这些错误仍然会向单一的分析服务的地方进行汇报。</p></li> <li><p>如果一个组件的继承或父级从属链路中存在多个 errorCaptured 钩子，则它们将会被相同的错误逐个唤起。</p></li> <li><p>如果此 errorCaptured 钩子自身抛出了一个错误，则这个新错误和原本被捕获的错误都会发送给全局的 config.errorHandler。</p></li> <li><p>一个 errorCaptured 钩子能够返回 false 以阻止错误继续向上传播。本质上是说“这个错误已经被搞定了且应该被忽略”。它会阻止其它任何会被这个错误唤起的 errorCaptured 钩子和全局的 config.errorHandler。</p></li></ul> <h2 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h2> <h3 id="q1-为什么生命周期函数不能使用箭头函数"><a href="#q1-为什么生命周期函数不能使用箭头函数" class="header-anchor">#</a> Q1. 为什么生命周期函数不能使用箭头函数</h3> <p>所有的生命周期钩子自动绑定 this 上下文到实例中，因此你可以访问数据，对 property 和方法进行运算。这意味着你不能使用箭头函数来定义一个生命周期方法 (例如 created: () =&gt; this.fetchTodos())。这是<strong>因为箭头函数绑定了父上下文，因此 this 与你期待的 Vue 实例不同</strong>，this.fetchTodos 的行为未定义。</p> <h3 id="q2-vue-的父组件和子组件生命周期钩子函数执行顺序"><a href="#q2-vue-的父组件和子组件生命周期钩子函数执行顺序" class="header-anchor">#</a> Q2. Vue 的父组件和子组件生命周期钩子函数执行顺序？</h3> <ul><li><p>加载渲染过程</p> <p>父 beforeCreate -&gt; 父 created -&gt; 父 beforeMount -&gt; 子 beforeCreate -&gt; 子 created -&gt; 子 beforeMount -&gt; 子 mounted -&gt; 父 mounted</p></li> <li><p>子组件更新过程</p> <p>父 beforeUpdate -&gt; 子 beforeUpdate -&gt; 子 updated -&gt; 父 updated</p></li> <li><p>父组件更新过程</p> <p>父 beforeUpdate -&gt; 父 updated</p></li> <li><p>销毁过程</p> <p>父 beforeDestroy -&gt; 子 beforeDestroy -&gt; 子 destroyed -&gt; 父 destroyed</p></li></ul> <h3 id="q3-在哪个生命周期内调用异步请求"><a href="#q3-在哪个生命周期内调用异步请求" class="header-anchor">#</a> Q3. 在哪个生命周期内调用异步请求？</h3> <p>如果组件在加载的时候需要和后端有交互，放在 beforeCreate、created、beforeMount、mounted 都可以，如果是需要访问 props、data 等数据的话，可以在钩子函数 created、beforeMount、mounted 中进行调用，因为在这三个钩子函数中，props、data 已经创建，可以将服务端端返回的数据进行赋值。但是本人推荐在 created 钩子函数中调用异步请求，因为在 created 钩子函数中调用异步请求有以下优点：</p> <ul><li>能更快获取到服务端数据，减少页面 loading 时间</li> <li>ssr 不支持 beforeMount 、mounted 钩子函数，所以放在 created 中有助于一致性</li></ul> <h3 id="q4-在什么阶段才能访问操作dom"><a href="#q4-在什么阶段才能访问操作dom" class="header-anchor">#</a> Q4. 在什么阶段才能访问操作DOM？</h3> <p>在钩子函数 mounted 被调用前，Vue 已经将编译好的模板挂载到页面上，所以在 mounted 中可以访问操作 DOM。vue 具体的生命周期示意图可以参见如下:</p> <p><img src="/blog/images/vue/vue%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%B3%A8%E9%87%8A.png" alt="vue生命周期注释"></p> <h3 id="q5-父组件可以监听到子组件的生命周期吗"><a href="#q5-父组件可以监听到子组件的生命周期吗" class="header-anchor">#</a> Q5. 父组件可以监听到子组件的生命周期吗？</h3> <p>比如有父组件 Parent 和子组件 Child，如果父组件监听到子组件挂载 mounted 就做一些逻辑处理，可以通过以下写法实现：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// Parent.vue</span>
<span class="token operator">&lt;</span>Child @mounted<span class="token operator">=</span><span class="token string">&quot;doSomething&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    
<span class="token comment">// Child.vue</span>
<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;mounted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>以上需要手动通过 $emit 触发父组件的事件，更简单的方式可以在父组件引用子组件时通过 @hook 来监听即可，如下所示：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//  Parent.vue</span>
<span class="token operator">&lt;</span>Child @hook<span class="token operator">:</span>mounted<span class="token operator">=</span><span class="token string">&quot;doSomething&quot;</span> <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Child<span class="token operator">&gt;</span>

<span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'父组件监听到 mounted 钩子函数 ...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
    
<span class="token comment">//  Child.vue</span>
<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'子组件触发 mounted 钩子函数 ...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>    
    
<span class="token comment">// 以上输出顺序为：</span>
<span class="token comment">// 子组件触发 mounted 钩子函数 ...</span>
<span class="token comment">// 父组件监听到 mounted 钩子函数 ...     </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>当然 @hook 方法不仅仅是可以监听 mounted，其它的生命周期事件，例如：created，updated 等都可以监听。</p> <h3 id="q6-v-model-的原理"><a href="#q6-v-model-的原理" class="header-anchor">#</a> Q6. v-model 的原理</h3> <p>我们在 vue 项目中主要使用 v-model 指令在表单 input、textarea、select 等元素上创建双向数据绑定，我们知道 v-model 本质上不过是语法糖，v-model 在内部为不同的输入元素使用不同的属性并抛出不同的事件：</p> <ul><li>text 和 textarea 元素使用 value 属性和 input 事件；</li> <li>checkbox 和 radio 使用 checked 属性和 change 事件；</li> <li>select 字段将 value 作为 prop 并将 change 作为事件。</li></ul> <p>以 input  表单元素为例：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>something<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    
相当于

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>something<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">v-on:</span>input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>something = $event.target.value<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/vue/vue/vue-nextTick.html" class="prev">
        异步更新队列
      </a></span> <span class="next"><a href="/blog/vue/vue/vue-computed.html">
        计算属性与侦听器
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----><!----></div></div>
    <script src="/blog/assets/js/app.faba343f.js" defer></script><script src="/blog/assets/js/2.55125c9d.js" defer></script><script src="/blog/assets/js/103.737ddbdf.js" defer></script><script src="/blog/assets/js/4.f8e09ced.js" defer></script>
  </body>
</html>
