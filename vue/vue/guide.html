<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js 高级技巧 | 花帽子的博客</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/blog/logo.png">
    <link rel="manifest" href="/blog/manifest.json">
    <link rel="apple-touch-icon" href="/blog/images/icons/apple-icon-152x152.png">
    <meta name="description" content="我命由我不由天，学习吧少年">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/blog/assets/css/0.styles.4a49bc7c.css" as="style"><link rel="preload" href="/blog/assets/js/app.8e3c4e3c.js" as="script"><link rel="preload" href="/blog/assets/js/2.2a4e8c54.js" as="script"><link rel="preload" href="/blog/assets/js/34.03e230e0.js" as="script"><link rel="preload" href="/blog/assets/js/4.2bef4353.js" as="script"><link rel="preload" href="/blog/assets/js/3.07d27621.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.8bc586ae.js"><link rel="prefetch" href="/blog/assets/js/11.dffbaf31.js"><link rel="prefetch" href="/blog/assets/js/12.99ded477.js"><link rel="prefetch" href="/blog/assets/js/13.5d9ddde9.js"><link rel="prefetch" href="/blog/assets/js/14.31478e4a.js"><link rel="prefetch" href="/blog/assets/js/15.15f879db.js"><link rel="prefetch" href="/blog/assets/js/16.014e0e4b.js"><link rel="prefetch" href="/blog/assets/js/17.6f2d16a9.js"><link rel="prefetch" href="/blog/assets/js/18.8f544422.js"><link rel="prefetch" href="/blog/assets/js/19.1243c36b.js"><link rel="prefetch" href="/blog/assets/js/20.d58dfb58.js"><link rel="prefetch" href="/blog/assets/js/21.0c26b5a2.js"><link rel="prefetch" href="/blog/assets/js/22.e7b3da39.js"><link rel="prefetch" href="/blog/assets/js/23.55982869.js"><link rel="prefetch" href="/blog/assets/js/24.6f093e2e.js"><link rel="prefetch" href="/blog/assets/js/25.816222a6.js"><link rel="prefetch" href="/blog/assets/js/26.372e2ea2.js"><link rel="prefetch" href="/blog/assets/js/27.d2f42b13.js"><link rel="prefetch" href="/blog/assets/js/28.7b4fa31d.js"><link rel="prefetch" href="/blog/assets/js/29.8555f961.js"><link rel="prefetch" href="/blog/assets/js/30.92fb85d7.js"><link rel="prefetch" href="/blog/assets/js/31.491bf9df.js"><link rel="prefetch" href="/blog/assets/js/32.7e42bda4.js"><link rel="prefetch" href="/blog/assets/js/33.1049c080.js"><link rel="prefetch" href="/blog/assets/js/35.3c360fe7.js"><link rel="prefetch" href="/blog/assets/js/36.f40ed418.js"><link rel="prefetch" href="/blog/assets/js/37.97d4e6e2.js"><link rel="prefetch" href="/blog/assets/js/38.5731e69b.js"><link rel="prefetch" href="/blog/assets/js/39.401cdb69.js"><link rel="prefetch" href="/blog/assets/js/40.5681cfae.js"><link rel="prefetch" href="/blog/assets/js/41.8df81454.js"><link rel="prefetch" href="/blog/assets/js/42.a8beb787.js"><link rel="prefetch" href="/blog/assets/js/43.d36b853e.js"><link rel="prefetch" href="/blog/assets/js/44.7b662c60.js"><link rel="prefetch" href="/blog/assets/js/45.d4830d14.js"><link rel="prefetch" href="/blog/assets/js/5.5d40c251.js"><link rel="prefetch" href="/blog/assets/js/6.08d6e999.js"><link rel="prefetch" href="/blog/assets/js/7.96560134.js"><link rel="prefetch" href="/blog/assets/js/8.f4a7eed1.js"><link rel="prefetch" href="/blog/assets/js/9.1ef431dd.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.4a49bc7c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/logo.png" alt="花帽子的博客" class="logo"> <span class="site-name can-hide">花帽子的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/vue/vue/vue-render.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/blog/css/basis/abstract.html" class="nav-link">
  CSS
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JS系列菜单" class="dropdown-title"><span class="title">JS</span> <span class="arrow down"></span></button> <button type="button" aria-label="JS系列菜单" class="mobile-dropdown-title"><span class="title">JS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/javascript/book/chapter1.html" class="nav-link">
  JavaScript红宝书
</a></li></ul></div></div><div class="nav-item"><a href="/blog/typescript/" class="nav-link">
  TS
</a></div><div class="nav-item"><a href="/blog/optimization/" class="nav-link">
  优化
</a></div><div class="nav-item"><a href="/blog/mobile/" class="nav-link">
  移动端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/jonny-wei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub地址
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/vue/vue/vue-render.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/blog/css/basis/abstract.html" class="nav-link">
  CSS
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JS系列菜单" class="dropdown-title"><span class="title">JS</span> <span class="arrow down"></span></button> <button type="button" aria-label="JS系列菜单" class="mobile-dropdown-title"><span class="title">JS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/javascript/book/chapter1.html" class="nav-link">
  JavaScript红宝书
</a></li></ul></div></div><div class="nav-item"><a href="/blog/typescript/" class="nav-link">
  TS
</a></div><div class="nav-item"><a href="/blog/optimization/" class="nav-link">
  优化
</a></div><div class="nav-item"><a href="/blog/mobile/" class="nav-link">
  移动端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/jonny-wei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub地址
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Vue秘籍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/vue/guide.html" aria-current="page" class="active sidebar-link">js 高级技巧</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#高级函数" class="sidebar-link">高级函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#安全的类型检测" class="sidebar-link">安全的类型检测</a></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#badge" class="sidebar-link">Badge</a></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#作用域安全的构造函数" class="sidebar-link">作用域安全的构造函数</a></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#惰性载入函数" class="sidebar-link">惰性载入函数</a></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#函数绑定" class="sidebar-link">函数绑定</a></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#函数科里化" class="sidebar-link">函数科里化</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#防篡改对象" class="sidebar-link">防篡改对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#不可扩展对象" class="sidebar-link">不可扩展对象</a></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#密封的对象" class="sidebar-link">密封的对象</a></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#冻结的对象" class="sidebar-link">冻结的对象</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#高级定时器" class="sidebar-link">高级定时器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#重复的定时器" class="sidebar-link">重复的定时器</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#数组分块" class="sidebar-link">数组分块</a></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#函数节流" class="sidebar-link">函数节流</a></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#自定义事件" class="sidebar-link">自定义事件</a></li><li class="sidebar-sub-header"><a href="/blog/vue/vue/guide.html#小结" class="sidebar-link">小结</a></li></ul></li><li><a href="/blog/vue/vue/vue-render.html" class="sidebar-link">vue渲染原理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue源码解析</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>VueRouter源码解析</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/vue-router/abstract.html" class="sidebar-link">摘要</a></li><li><a href="/blog/vue/vue-router/warmUp.html" class="sidebar-link">准备工作</a></li><li><a href="/blog/vue/vue-router/plugin.html" class="sidebar-link">插件机制</a></li><li><a href="/blog/vue/vue-router/initialization.html" class="sidebar-link">初始化与降级处理</a></li><li><a href="/blog/vue/vue-router/transitions.html" class="sidebar-link">路由过渡与视图渲染</a></li><li><a href="/blog/vue/vue-router/match.html" class="sidebar-link">路由匹配</a></li><li><a href="/blog/vue/vue-router/scroll.html" class="sidebar-link">滚动行为处理</a></li><li><a href="/blog/vue/vue-router/summary.html" class="sidebar-link">总结</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vuex源码解析</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/vuex/abstract.html" class="sidebar-link">摘要</a></li><li><a href="/blog/vue/vuex/warmUp.html" class="sidebar-link">准备工作</a></li><li><a href="/blog/vue/vuex/initialization.html" class="sidebar-link">初始化与模块安装</a></li><li><a href="/blog/vue/vuex/state.html" class="sidebar-link">State 相关</a></li><li><a href="/blog/vue/vuex/getters.html" class="sidebar-link">Getters 相关</a></li><li><a href="/blog/vue/vuex/mutations.html" class="sidebar-link">Mutations 相关</a></li><li><a href="/blog/vue/vuex/actions.html" class="sidebar-link">Actions 相关</a></li><li><a href="/blog/vue/vuex/modules.html" class="sidebar-link">Modules 相关</a></li><li><a href="/blog/vue/vuex/others.html" class="sidebar-link">其他</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue3新特性</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/vue3.x/abstract.html" class="sidebar-link">摘要</a></li><li><a href="/blog/vue/vue3.x/reactivity.html" class="sidebar-link">响应式系统</a></li><li><a href="/blog/vue/vue3.x/features.html" class="sidebar-link">功能方面</a></li><li><a href="/blog/vue/vue3.x/performance.html" class="sidebar-link">性能方面</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="js-高级技巧"><a href="#js-高级技巧" class="header-anchor">#</a> js 高级技巧</h1> <h2 id="高级函数"><a href="#高级函数" class="header-anchor">#</a> 高级函数</h2> <h3 id="安全的类型检测"><a href="#安全的类型检测" class="header-anchor">#</a> 安全的类型检测</h3> <ul><li>js 内置的类型检测并非完全可靠，typeof 操作符难以判断某个值是否为函数</li> <li>instanceof 在多个 frame 的情况下，会出现问题。
例如：<code>var isArray = value instance of Array ;</code>
会由于存在多个 window，而 value 与 Array 不属于同个 window 的情况而导致出错</li></ul> <p>对于这样的问题，最好的解决方法是通过调用 Object 的 toString 方法，例如：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">isArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object Array]'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><img src="/blog/images/0001.png" alt="0001"> <p><img src="/blog/images/0001.png" alt="0001图片"></p> <h3 id="badge"><a href="#badge" class="header-anchor">#</a> Badge <span class="badge warn" style="vertical-align:top;" data-v-15b7b770>beta</span> <span class="badge error" style="vertical-align:top;" data-v-15b7b770>0.10.1+</span> <span class="badge tip" style="vertical-align:top;" data-v-15b7b770>默认主题</span></h3> <p>🎉 💯 🦁</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>This is a tip</p></div> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>This is a warning</p></div> <div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>This is a dangerous warning</p></div> <h3 id="作用域安全的构造函数"><a href="#作用域安全的构造函数" class="header-anchor">#</a> 作用域安全的构造函数</h3> <p>调用构造函数的时候，如果忘记写 new 的话，构造函数中对 this 的赋值，则可能会赋值到 window 上成为全局变量，导致其他错误。
可以在构造函数增加判断来避免这种错误,如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="惰性载入函数"><a href="#惰性载入函数" class="header-anchor">#</a> 惰性载入函数</h3> <p>在程序中 ，类似对浏览器的检测等，进行一次检测过后，只要在当前环境下，其检测结果都不会改变。所以，我们的函数中 if 语句只需要判断一次就可以了，而不需要每次都执行。
对这种情况的解决方案便称为惰性载入。
惰性载入表示函数执行的分支仅会发生一次。</p> <h4 id="惰性载入两种实现方法"><a href="#惰性载入两种实现方法" class="header-anchor">#</a> 惰性载入两种实现方法：</h4> <ul><li>替换真正执行的方法，伪代码如下：</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>someCheck<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">doSomeThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">doAnotherSomeThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>声明函数时就指定适当的函数。通过匿名自执行函数</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>someCheck<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">doSomeThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">doAnotherSomeThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这样，在代码首次载入的时候，就已经得到对应的值了</p> <h3 id="函数绑定"><a href="#函数绑定" class="header-anchor">#</a> 函数绑定</h3> <p>先看一个例子：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    message<span class="token operator">:</span> <span class="token string">'handler message'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">handlerClick</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//用于将某个函数绑定到指定环境</span>
<span class="token keyword">var</span> <span class="token function-variable function">bind</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> nomalBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'nomalBtn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> bindBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'bindBtn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

nomalBtn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> handler<span class="token punctuation">.</span>handlerClick<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//点击时候会打印 undefined</span>
bindBtn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token function">bind</span><span class="token punctuation">(</span>handler<span class="token punctuation">.</span>handlerClick<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//点击按钮会打印 handler.message的值</span>
</code></pre></div><p>在上面的例子中，我们需要对象中的方法作为事件处理程序。但是，当事件触发时，this 的指向却不是 handler 而是按钮本身。
解决方法可以使用匿名函数，但是，过多的匿名函数会令代码变的难于理解与调试，因此，推荐使用 bind 方法。</p> <blockquote><p>ES5 为函数定义了一个原生的 bind 方法，也就是说，你不必自己实现 bind 方法，只需要直接在函数上调用即可<code>handler.handlerClick.bind(handler) ;</code></p></blockquote> <h3 id="函数科里化"><a href="#函数科里化" class="header-anchor">#</a> 函数科里化</h3> <p>函数科里化是用于创建已经设置好一个或多个参数的函数。缩小了函数的适用范围，但提高函数的适性。
例如：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//普通的add版本</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//第一个参数为5的add版本</span>
<span class="token keyword">function</span> <span class="token function">curriedAdd5</span><span class="token punctuation">(</span><span class="token parameter">num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> num2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面只是一个展示柯里化概念的例子。创建柯里化函数有一个通用方式：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//截取调用curry时候，除了fn,context,之后的所有参数</span>
    <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//获取调用fn的所有参数</span>
        <span class="token keyword">var</span> totalArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> totalArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样，上面的例子中 curriedAdd5 可以用另一个方法来创建 <code>var curriedAdd5 = curry(add, null, 5)</code></p> <p>javascript 中的柯里化函数和 bind 函数提供了强大的动态函数创建功能，但是两者都不应该滥用，因为每个函数都带来额外的开销</p> <h2 id="防篡改对象"><a href="#防篡改对象" class="header-anchor">#</a> 防篡改对象</h2> <h3 id="不可扩展对象"><a href="#不可扩展对象" class="header-anchor">#</a> 不可扩展对象</h3> <p>不可扩展表示不能给该对象添加新属性和新方法，非严格情况下会静默失败，严格模式下会报错
主要有两个方法：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将对象定义为不可扩展的</span>
Object<span class="token punctuation">.</span><span class="token function">isExtensible</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 判读对象是否可以扩展</span>
</code></pre></div><h3 id="密封的对象"><a href="#密封的对象" class="header-anchor">#</a> 密封的对象</h3> <p>密封的对象表示不可扩展，且成员 Configurable 特性为 false，即不能删除属性和方法，也不能修改属性的特性
主要有两个方法：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Object<span class="token punctuation">.</span><span class="token function">seal</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将对象定义为密封的</span>
Object<span class="token punctuation">.</span><span class="token function">isSealed</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 判读对象是否密封</span>
</code></pre></div><h3 id="冻结的对象"><a href="#冻结的对象" class="header-anchor">#</a> 冻结的对象</h3> <p>冻结的对象是最严格的反篡改级别。即不可扩展，又是密封的，且数据属性的 writable 特性为 false。如果定义了[[set]]函数,访问器属性还是可写的
主要有两个方法：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将对象定义冻结对象</span>
Object<span class="token punctuation">.</span><span class="token function">isFrozen</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 判读对象被冻结</span>
</code></pre></div><p>对于 js 库的作者而言，冻结对象很有用，因为 js 库最怕有人意外修改了库中的核心对象。</p> <h2 id="高级定时器"><a href="#高级定时器" class="header-anchor">#</a> 高级定时器</h2> <h3 id="重复的定时器"><a href="#重复的定时器" class="header-anchor">#</a> 重复的定时器</h3> <p>setInterval ： 创建的定时器确保了定时器代码规则的插入队列中。
但是会有两个问题：</p> <ol><li>某些间隔会被跳过</li> <li>多个定时器的代码执行之间的间隔可能比预期的小</li></ol> <p>为了避免这两个问题，可以用如下模式使用链式 setTimeout。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>callee<span class="token punctuation">,</span> intervalTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> intervalTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这样可以确保不会有缺失的间隔，而且之间的间隔比预期的大</p> <h2 id="数组分块"><a href="#数组分块" class="header-anchor">#</a> 数组分块</h2> <p>由于 js 是单线程的，有时候一个耗时的操作会阻塞线程，导致这段时间用户无法与界面交互。
如果是某个循环比较耗时，并且该循环并不必须同步完成，就可以使用**<em>数组分块</em>**的技术，小块小块的处理数组，给主线程有空闲的机会，就可以不影响用户的操作。
实现数组分块非常简单：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">chunk</span><span class="token punctuation">(</span><span class="token parameter">array<span class="token punctuation">,</span> process<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> item <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">process</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>array<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>callee<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用的时候直接将要分块的数组以及处理程序作为参数即可</p> <blockquote><p>一旦某个函数需要花 50ms 以上的时间完成，就可以考虑能否分隔成多个小任务来完成</p></blockquote> <h2 id="函数节流"><a href="#函数节流" class="header-anchor">#</a> 函数节流</h2> <p>浏览器中，某些计算和处理要比其他的昂贵的多。如果在触发频率很高的事件中去执行这些操作，有可能会导致浏览器第崩溃。函数节流就是为了解决这个问题
函数节流背后的思想是指，某些代码不可以在没有间断的情况下重复执行。第一次调用函数，创建一个定时器，在指定的时间间隔之后运行代码。当第二次调用函数时，清除前一次的定时器，并设置另一个。这样只有在执行函数的请求停止了之后才执行。</p> <h2 id="自定义事件"><a href="#自定义事件" class="header-anchor">#</a> 自定义事件</h2> <p>观察者模式</p> <p style="color:red;">（尚未详细了解）</p> <h2 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h2> <p>js 中的函数非常强大，因为它们是第一类对象。使用闭包和函数环境切换，还可以有很多函数的强大方法。
善于使用高级函数来实现更好的功能。
善于使用观察者模式来使不同部分的代码之间解耦，让维护更容易</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最近更新:</span> <span class="time">11/11/2020, 10:11:04 AM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/blog/vue/vue/vue-render.html">
        vue渲染原理
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----><!----></div></div>
    <script src="/blog/assets/js/app.8e3c4e3c.js" defer></script><script src="/blog/assets/js/2.2a4e8c54.js" defer></script><script src="/blog/assets/js/34.03e230e0.js" defer></script><script src="/blog/assets/js/4.2bef4353.js" defer></script><script src="/blog/assets/js/3.07d27621.js" defer></script>
  </body>
</html>
