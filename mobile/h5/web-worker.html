<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Web Worker | 前端那些事儿</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/blog/logo.png">
    <link rel="manifest" href="/blog/manifest.json">
    <link rel="apple-touch-icon" href="/blog/images/icons/apple-icon-152x152.png">
    <meta name="description" content="我命由我不由天，学习吧少年">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/blog/assets/css/0.styles.f0017422.css" as="style"><link rel="preload" href="/blog/assets/js/app.f064466e.js" as="script"><link rel="preload" href="/blog/assets/js/2.dec2e75d.js" as="script"><link rel="preload" href="/blog/assets/js/1.5b9e135c.js" as="script"><link rel="preload" href="/blog/assets/js/135.55b14adc.js" as="script"><link rel="preload" href="/blog/assets/js/20.badbb211.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.cc7e09f3.js"><link rel="prefetch" href="/blog/assets/js/100.092e3032.js"><link rel="prefetch" href="/blog/assets/js/101.a01f5a9d.js"><link rel="prefetch" href="/blog/assets/js/102.354eb4d9.js"><link rel="prefetch" href="/blog/assets/js/103.551b01d6.js"><link rel="prefetch" href="/blog/assets/js/104.4195509f.js"><link rel="prefetch" href="/blog/assets/js/105.5bcfb334.js"><link rel="prefetch" href="/blog/assets/js/106.4d5cd4f9.js"><link rel="prefetch" href="/blog/assets/js/107.56728416.js"><link rel="prefetch" href="/blog/assets/js/108.238ec3f7.js"><link rel="prefetch" href="/blog/assets/js/109.f692a551.js"><link rel="prefetch" href="/blog/assets/js/11.b60c9933.js"><link rel="prefetch" href="/blog/assets/js/110.d9eafe6c.js"><link rel="prefetch" href="/blog/assets/js/111.9786ad77.js"><link rel="prefetch" href="/blog/assets/js/112.c095d75c.js"><link rel="prefetch" href="/blog/assets/js/113.d7cac620.js"><link rel="prefetch" href="/blog/assets/js/114.b45e47bc.js"><link rel="prefetch" href="/blog/assets/js/115.6231612c.js"><link rel="prefetch" href="/blog/assets/js/116.7a3e466d.js"><link rel="prefetch" href="/blog/assets/js/117.b0193462.js"><link rel="prefetch" href="/blog/assets/js/118.ca6cc5f7.js"><link rel="prefetch" href="/blog/assets/js/119.a272e5e9.js"><link rel="prefetch" href="/blog/assets/js/12.c53283e7.js"><link rel="prefetch" href="/blog/assets/js/120.e411196d.js"><link rel="prefetch" href="/blog/assets/js/121.25dc3fe6.js"><link rel="prefetch" href="/blog/assets/js/122.7298b7a6.js"><link rel="prefetch" href="/blog/assets/js/123.f2992c18.js"><link rel="prefetch" href="/blog/assets/js/124.e82e9f6c.js"><link rel="prefetch" href="/blog/assets/js/125.dc111900.js"><link rel="prefetch" href="/blog/assets/js/126.6169b7ee.js"><link rel="prefetch" href="/blog/assets/js/127.ac83a046.js"><link rel="prefetch" href="/blog/assets/js/128.7da5e812.js"><link rel="prefetch" href="/blog/assets/js/129.b7120c7a.js"><link rel="prefetch" href="/blog/assets/js/13.6bdc6b5d.js"><link rel="prefetch" href="/blog/assets/js/130.4b4024eb.js"><link rel="prefetch" href="/blog/assets/js/131.915eca3b.js"><link rel="prefetch" href="/blog/assets/js/132.a72163a9.js"><link rel="prefetch" href="/blog/assets/js/133.80240bab.js"><link rel="prefetch" href="/blog/assets/js/134.59a9c10e.js"><link rel="prefetch" href="/blog/assets/js/136.7f5d49d2.js"><link rel="prefetch" href="/blog/assets/js/137.d874e123.js"><link rel="prefetch" href="/blog/assets/js/138.ecaa45d9.js"><link rel="prefetch" href="/blog/assets/js/139.ca36818f.js"><link rel="prefetch" href="/blog/assets/js/14.c3201a23.js"><link rel="prefetch" href="/blog/assets/js/140.313b4b35.js"><link rel="prefetch" href="/blog/assets/js/141.fabdffe8.js"><link rel="prefetch" href="/blog/assets/js/142.a43fa987.js"><link rel="prefetch" href="/blog/assets/js/143.163b1e09.js"><link rel="prefetch" href="/blog/assets/js/144.fc4e0adb.js"><link rel="prefetch" href="/blog/assets/js/145.daf7f222.js"><link rel="prefetch" href="/blog/assets/js/146.615ab8bc.js"><link rel="prefetch" href="/blog/assets/js/147.2c1841e6.js"><link rel="prefetch" href="/blog/assets/js/148.b91d11d4.js"><link rel="prefetch" href="/blog/assets/js/149.14e85f73.js"><link rel="prefetch" href="/blog/assets/js/15.a0b9e44e.js"><link rel="prefetch" href="/blog/assets/js/150.cfc330ab.js"><link rel="prefetch" href="/blog/assets/js/151.ebf83a39.js"><link rel="prefetch" href="/blog/assets/js/152.0a73be52.js"><link rel="prefetch" href="/blog/assets/js/153.8343bfc8.js"><link rel="prefetch" href="/blog/assets/js/154.a1a2eb79.js"><link rel="prefetch" href="/blog/assets/js/155.f698eea1.js"><link rel="prefetch" href="/blog/assets/js/156.a811446e.js"><link rel="prefetch" href="/blog/assets/js/157.0dbe96cb.js"><link rel="prefetch" href="/blog/assets/js/158.6a9a1c38.js"><link rel="prefetch" href="/blog/assets/js/159.9286efb1.js"><link rel="prefetch" href="/blog/assets/js/16.491191e4.js"><link rel="prefetch" href="/blog/assets/js/160.baa0ba8a.js"><link rel="prefetch" href="/blog/assets/js/161.e33c0e8b.js"><link rel="prefetch" href="/blog/assets/js/162.54cf777a.js"><link rel="prefetch" href="/blog/assets/js/163.7ee5e5cb.js"><link rel="prefetch" href="/blog/assets/js/164.cfb88055.js"><link rel="prefetch" href="/blog/assets/js/165.15a2bb66.js"><link rel="prefetch" href="/blog/assets/js/166.6e3d209a.js"><link rel="prefetch" href="/blog/assets/js/167.4c0d455c.js"><link rel="prefetch" href="/blog/assets/js/168.5120246b.js"><link rel="prefetch" href="/blog/assets/js/169.8736d1ee.js"><link rel="prefetch" href="/blog/assets/js/17.89ec8c57.js"><link rel="prefetch" href="/blog/assets/js/170.21af58b6.js"><link rel="prefetch" href="/blog/assets/js/171.0e3f28f1.js"><link rel="prefetch" href="/blog/assets/js/172.7cfd3207.js"><link rel="prefetch" href="/blog/assets/js/173.a2dac462.js"><link rel="prefetch" href="/blog/assets/js/174.d176a202.js"><link rel="prefetch" href="/blog/assets/js/175.a3bde410.js"><link rel="prefetch" href="/blog/assets/js/176.f1f211e6.js"><link rel="prefetch" href="/blog/assets/js/177.ea36edee.js"><link rel="prefetch" href="/blog/assets/js/178.3315e121.js"><link rel="prefetch" href="/blog/assets/js/179.dcab2bcc.js"><link rel="prefetch" href="/blog/assets/js/18.b91f1411.js"><link rel="prefetch" href="/blog/assets/js/180.9317de32.js"><link rel="prefetch" href="/blog/assets/js/181.1f7dc615.js"><link rel="prefetch" href="/blog/assets/js/182.3f627730.js"><link rel="prefetch" href="/blog/assets/js/183.0aae9e4d.js"><link rel="prefetch" href="/blog/assets/js/184.02e612bc.js"><link rel="prefetch" href="/blog/assets/js/185.69086931.js"><link rel="prefetch" href="/blog/assets/js/186.bd208371.js"><link rel="prefetch" href="/blog/assets/js/187.36617b89.js"><link rel="prefetch" href="/blog/assets/js/188.1218d015.js"><link rel="prefetch" href="/blog/assets/js/189.eb1628e7.js"><link rel="prefetch" href="/blog/assets/js/19.cb1f17c8.js"><link rel="prefetch" href="/blog/assets/js/190.c2837a50.js"><link rel="prefetch" href="/blog/assets/js/191.de4c52a2.js"><link rel="prefetch" href="/blog/assets/js/192.fe63255b.js"><link rel="prefetch" href="/blog/assets/js/193.0cd0acb5.js"><link rel="prefetch" href="/blog/assets/js/194.c768d736.js"><link rel="prefetch" href="/blog/assets/js/195.96aee012.js"><link rel="prefetch" href="/blog/assets/js/196.e710792c.js"><link rel="prefetch" href="/blog/assets/js/197.76ca820f.js"><link rel="prefetch" href="/blog/assets/js/198.5a39c6b2.js"><link rel="prefetch" href="/blog/assets/js/199.5a40ce24.js"><link rel="prefetch" href="/blog/assets/js/200.caed4672.js"><link rel="prefetch" href="/blog/assets/js/201.9548a796.js"><link rel="prefetch" href="/blog/assets/js/202.01cd4db0.js"><link rel="prefetch" href="/blog/assets/js/203.2c0f5719.js"><link rel="prefetch" href="/blog/assets/js/204.1fd518d5.js"><link rel="prefetch" href="/blog/assets/js/205.8e640cc0.js"><link rel="prefetch" href="/blog/assets/js/206.8e05dadc.js"><link rel="prefetch" href="/blog/assets/js/207.9d91e0f0.js"><link rel="prefetch" href="/blog/assets/js/208.871c410a.js"><link rel="prefetch" href="/blog/assets/js/209.c989e52c.js"><link rel="prefetch" href="/blog/assets/js/21.bf0041b7.js"><link rel="prefetch" href="/blog/assets/js/210.ec861054.js"><link rel="prefetch" href="/blog/assets/js/211.d97e0d8f.js"><link rel="prefetch" href="/blog/assets/js/212.41aa6b33.js"><link rel="prefetch" href="/blog/assets/js/213.6beb6476.js"><link rel="prefetch" href="/blog/assets/js/214.ecb9407f.js"><link rel="prefetch" href="/blog/assets/js/215.dc28f7ea.js"><link rel="prefetch" href="/blog/assets/js/216.ef219cb8.js"><link rel="prefetch" href="/blog/assets/js/217.b1bc396a.js"><link rel="prefetch" href="/blog/assets/js/22.48390d4f.js"><link rel="prefetch" href="/blog/assets/js/23.35c4ba93.js"><link rel="prefetch" href="/blog/assets/js/24.cc3b12df.js"><link rel="prefetch" href="/blog/assets/js/25.632a83cc.js"><link rel="prefetch" href="/blog/assets/js/26.dc0735bf.js"><link rel="prefetch" href="/blog/assets/js/27.cc85ad1c.js"><link rel="prefetch" href="/blog/assets/js/28.8db05f53.js"><link rel="prefetch" href="/blog/assets/js/29.fb4096e5.js"><link rel="prefetch" href="/blog/assets/js/3.cb0627fa.js"><link rel="prefetch" href="/blog/assets/js/30.17850991.js"><link rel="prefetch" href="/blog/assets/js/31.242683bb.js"><link rel="prefetch" href="/blog/assets/js/32.bf429371.js"><link rel="prefetch" href="/blog/assets/js/33.6ba2a392.js"><link rel="prefetch" href="/blog/assets/js/34.97963f66.js"><link rel="prefetch" href="/blog/assets/js/35.e732926b.js"><link rel="prefetch" href="/blog/assets/js/36.f59db662.js"><link rel="prefetch" href="/blog/assets/js/37.2adb7b7a.js"><link rel="prefetch" href="/blog/assets/js/38.0e4f5d2b.js"><link rel="prefetch" href="/blog/assets/js/39.bc8bdb2d.js"><link rel="prefetch" href="/blog/assets/js/4.cbb57fa7.js"><link rel="prefetch" href="/blog/assets/js/40.fd3db312.js"><link rel="prefetch" href="/blog/assets/js/41.3df10542.js"><link rel="prefetch" href="/blog/assets/js/42.24c30e2f.js"><link rel="prefetch" href="/blog/assets/js/43.b77505bf.js"><link rel="prefetch" href="/blog/assets/js/44.2fe040db.js"><link rel="prefetch" href="/blog/assets/js/45.d1ff2718.js"><link rel="prefetch" href="/blog/assets/js/46.ac4c50a9.js"><link rel="prefetch" href="/blog/assets/js/47.be6cf846.js"><link rel="prefetch" href="/blog/assets/js/48.49c3bebf.js"><link rel="prefetch" href="/blog/assets/js/49.66813cef.js"><link rel="prefetch" href="/blog/assets/js/5.fe065607.js"><link rel="prefetch" href="/blog/assets/js/50.a59a1e39.js"><link rel="prefetch" href="/blog/assets/js/51.a7690724.js"><link rel="prefetch" href="/blog/assets/js/52.cec8f88e.js"><link rel="prefetch" href="/blog/assets/js/53.5a7e2462.js"><link rel="prefetch" href="/blog/assets/js/54.28a6163c.js"><link rel="prefetch" href="/blog/assets/js/55.ab7cb738.js"><link rel="prefetch" href="/blog/assets/js/56.43a18261.js"><link rel="prefetch" href="/blog/assets/js/57.9e6af602.js"><link rel="prefetch" href="/blog/assets/js/58.592a495a.js"><link rel="prefetch" href="/blog/assets/js/59.0077967c.js"><link rel="prefetch" href="/blog/assets/js/6.68cda050.js"><link rel="prefetch" href="/blog/assets/js/60.61e93e53.js"><link rel="prefetch" href="/blog/assets/js/61.70b9139c.js"><link rel="prefetch" href="/blog/assets/js/62.b9e107be.js"><link rel="prefetch" href="/blog/assets/js/63.27a4a598.js"><link rel="prefetch" href="/blog/assets/js/64.89c0e1b1.js"><link rel="prefetch" href="/blog/assets/js/65.29b44d0e.js"><link rel="prefetch" href="/blog/assets/js/66.503fbcc3.js"><link rel="prefetch" href="/blog/assets/js/67.9060f240.js"><link rel="prefetch" href="/blog/assets/js/68.3616a779.js"><link rel="prefetch" href="/blog/assets/js/69.ddb99194.js"><link rel="prefetch" href="/blog/assets/js/7.3b8d63a0.js"><link rel="prefetch" href="/blog/assets/js/70.ef2df8e0.js"><link rel="prefetch" href="/blog/assets/js/71.92541e1d.js"><link rel="prefetch" href="/blog/assets/js/72.187dd3c8.js"><link rel="prefetch" href="/blog/assets/js/73.5af024ef.js"><link rel="prefetch" href="/blog/assets/js/74.28b44d4b.js"><link rel="prefetch" href="/blog/assets/js/75.d9f3b129.js"><link rel="prefetch" href="/blog/assets/js/76.e710d0f9.js"><link rel="prefetch" href="/blog/assets/js/77.59bee4e8.js"><link rel="prefetch" href="/blog/assets/js/78.3e5da7b2.js"><link rel="prefetch" href="/blog/assets/js/79.b588307d.js"><link rel="prefetch" href="/blog/assets/js/80.944e9246.js"><link rel="prefetch" href="/blog/assets/js/81.1abf4136.js"><link rel="prefetch" href="/blog/assets/js/82.8a6dc316.js"><link rel="prefetch" href="/blog/assets/js/83.49fe7db4.js"><link rel="prefetch" href="/blog/assets/js/84.99eb528d.js"><link rel="prefetch" href="/blog/assets/js/85.31f56ab1.js"><link rel="prefetch" href="/blog/assets/js/86.01130ae0.js"><link rel="prefetch" href="/blog/assets/js/87.0c38021a.js"><link rel="prefetch" href="/blog/assets/js/88.95dd3549.js"><link rel="prefetch" href="/blog/assets/js/89.c1fa1707.js"><link rel="prefetch" href="/blog/assets/js/90.790bbd0b.js"><link rel="prefetch" href="/blog/assets/js/91.8bd2e080.js"><link rel="prefetch" href="/blog/assets/js/92.7c81c7c2.js"><link rel="prefetch" href="/blog/assets/js/93.9f5209e3.js"><link rel="prefetch" href="/blog/assets/js/94.70ee66b4.js"><link rel="prefetch" href="/blog/assets/js/95.235343c1.js"><link rel="prefetch" href="/blog/assets/js/96.eb5c2704.js"><link rel="prefetch" href="/blog/assets/js/97.b1e3b815.js"><link rel="prefetch" href="/blog/assets/js/98.9b37860e.js"><link rel="prefetch" href="/blog/assets/js/99.746f24e0.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.bd3cdb54.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.f0017422.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/logo.png" alt="前端那些事儿" class="logo"> <span class="site-name can-hide">前端那些事儿</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/base/" class="nav-link">
  前端基础
</a></div><div class="nav-item"><a href="/blog/vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/blog/react/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/blog/devops/" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/blog/mobile/" class="nav-link router-link-active">
  泛客户端
</a></div><div class="nav-item"><a href="/blog/architecture/" class="nav-link">
  架构与方案
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/jonny-wei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/jonny-wei/sushi-js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JS 寿司
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/base/" class="nav-link">
  前端基础
</a></div><div class="nav-item"><a href="/blog/vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/blog/react/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/blog/devops/" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/blog/mobile/" class="nav-link router-link-active">
  泛客户端
</a></div><div class="nav-item"><a href="/blog/architecture/" class="nav-link">
  架构与方案
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/jonny-wei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/jonny-wei/sushi-js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JS 寿司
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>跨端技术</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/mobile/" aria-current="page" class="sidebar-link">跨端技术通识</a></li><li><a href="/blog/mobile/h5/webview.html" class="sidebar-link">WebView</a></li><li><a href="/blog/mobile/h5/jsbridge.html" class="sidebar-link">JSBridge</a></li><li><a href="/blog/mobile/h5/mobile-fit.html" class="sidebar-link">H5 移动端适配</a></li><li><a href="/blog/mobile/h5/web-worker.html" aria-current="page" class="active sidebar-link">Web Worker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/mobile/h5/web-worker.html#概览" class="sidebar-link">概览</a></li><li class="sidebar-sub-header"><a href="/blog/mobile/h5/web-worker.html#使用方式" class="sidebar-link">使用方式</a></li><li class="sidebar-sub-header"><a href="/blog/mobile/h5/web-worker.html#应用场景" class="sidebar-link">应用场景</a></li></ul></li><li><a href="/blog/mobile/h5/rn.html" class="sidebar-link">RN 新架构</a></li><li><a href="/blog/mobile/h5/rn-fabric.html" class="sidebar-link">RN Fabric 渲染系统</a></li><li><a href="/blog/mobile/h5/rn-multithreads.html" class="sidebar-link">RN 多线程与渲染</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>小程序</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/mobile/mini/framework.html" class="sidebar-link">双线程架构</a></li><li><a href="/blog/mobile/mini/render.html" class="sidebar-link">数据通信与渲染</a></li><li><a href="/blog/mobile/mini/page.html" class="sidebar-link">页面管理与跳转</a></li><li><a href="/blog/mobile/mini/security.html" class="sidebar-link">安全管控与登录</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="web-worker"><a href="#web-worker" class="header-anchor">#</a> Web Worker</h1> <h2 id="概览"><a href="#概览" class="header-anchor">#</a> 概览</h2> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p>Web Worker 作为浏览器多线程技术，在当下，成为缓解页面卡顿,，提升应用性能的可选方案。Web Worker 实现了多线程运行 JS 能力，使 JS 可以并行执行，进而提升执行效率，加之运行任务拆分，减少页面卡顿。</p> <p>由于 JavaScript 语言采用的是单线程，同一时刻只能做一件事，如果有多个同步计算任务执行，则在这段同步计算逻辑执行完之前，它下方的代码不会执行，从而造成了阻塞，用户的交互也可能无响应。但如果把这段同步计算逻辑放到 Web Worker 执行，在这段逻辑计算运行期间依然可以执行它下方的代码，用户的操作也可以响应了。<strong>Web Worker 的作用，就是为 JavaScript 创造多线程环境，允许主线程创建 Worker 线程，将一些任务分配给后者运行</strong>。这样的好处是，一些计算密集型或高延迟的任务，被 Worker 线程负担了，主线程就会很流畅，不会被阻塞或拖慢。</p> <h4 id="多线程与主线程"><a href="#多线程与主线程" class="header-anchor">#</a> 多线程与主线程</h4> <p>Web Worker 会创建操作系统级别的线程。JS 多线程, 是有独立于主线程的 JS 运行环境。</p> <p><img src="/blog/images/architecture/webworker1.png" alt="webworker1"></p> <p>如图所示:，Worker 线程有独立的内存空间, <code>Message Queue</code>, <code>Event Loop</code>, <code>Call Stack</code> 等, 线程间通过 <code>postMessage</code> 通信。</p> <p><strong>Web Worker 多线程并发与异步编程中的并发之间的区别</strong>：</p> <p>Web Worker 多个线程可以并发运行 JS。这里不同于 JS 异步编程中的并发（Promise.all），JS 单线程中的&quot;并发&quot;, 准确来说是 Concurrent。运行时只有一个函数调用栈, 通过 Event Loop 实现不同 Task 的上下文切换(Context Switch)。这些 Task 通过 BOM API 调起其他线程为主线程工作，但回调函数代码逻辑依然由 JS 串行运行。</p> <p>Web Worker 是 JS 多线程运行技术, 准确来说是 Parallel。其与 Concurrent 的区别在于 Parallel 有多个函数调用栈， 每个函数调用栈可以独立运行 Task，互不干扰。</p> <h3 id="分类"><a href="#分类" class="header-anchor">#</a> 分类</h3> <p>Web Worker 规范中包括（不包括 <code>Service Worker</code>）:</p> <ul><li><p><code>DedicatedWorker</code>（专用线程）：简称 Worker, 其线程只能与一个页面渲染进程(Render Process)进行绑定和通信, 不能多 Tab 共享。<code>DedicatedWorker</code> 是最早实现并最广泛支持的 Web Worker 能力。</p></li> <li><p>SharedWorker（共享线程）：可以在多个浏览器 Tab 中访问到同一个 Worker 实例，实现多 Tab 共享数据，共享 <code>webSocket</code> 连接等。看起来很美好， 但 safari 放弃了 <code>SharedWorker</code> 支持，因为 <code>webkit</code> 引擎的技术原因。</p></li></ul> <p>本文后面讨论中的 Worker 都是特指 <code>DedicatedWorker</code>。</p> <h3 id="使用限制"><a href="#使用限制" class="header-anchor">#</a> 使用限制</h3> <p>Worker 运行环境与主线程的共同点主要包括:</p> <ul><li>包含完整的 JS 运行时, 支持 ECMAScript 规范定义的语言语法和内置对象.</li> <li>支持 <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FXMLHttpRequest" target="_blank" rel="noopener noreferrer">XmlHttpRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, 能独立发送网络请求与后台交互.</li> <li>包含<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWorkerLocation" target="_blank" rel="noopener noreferrer">只读的 Location<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, 指向 Worker 线程执行的 script url, 可通过 url 传递参数给 Worker 环境.</li> <li>包含<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWorkerNavigator" target="_blank" rel="noopener noreferrer">只读的 Navigator<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, 用于获取浏览器信息, 如通过 <code>Navigator.userAgent</code> 识别浏览器.</li> <li>支持 setTimeout / setInterval 计时器, 可用于实现异步逻辑.</li> <li>支持 WebSocket 进行网络 I/O; 支持 IndexedDB 进行文件 I/O.</li></ul> <p>从共同点上看, Worker 线程其实很强大, 除了利用独立线程执行重度逻辑外, 其网络 I/O 和文件 I/O 能力给业务和技术方案带来很大的想象空间</p> <p>另一方面, Worker 线程运行环境和主线程的差异点有:</p> <ul><li>Worker 线程没有 DOM API, 无法新建和操作 DOM; 也无法访问到主线程的 DOM Element.</li> <li>Worker 线程和主线程间内存独立, Worker 线程无法访问页面上的全局变量(window, document 等)和 JS 函数.</li> <li>Worker 线程不能调用 alert() 或 confirm() 等 UI 相关的 BOM API.</li> <li>Worker 线程被主线程控制, 主线程可以新建和销毁 Worker.</li> <li>Worker 线程可以通过 <code>self.close</code> 自行销毁.</li></ul> <p>从差异点上看, Worker 线程无法染指 UI, 并受主线程控制, 适合默默干活.</p> <h4 id="同源限制"><a href="#同源限制" class="header-anchor">#</a> 同源限制</h4> <p>分配给 Worker 线程运行的脚本文件，必须与主线程的脚本文件同源。</p> <h4 id="文件限制"><a href="#文件限制" class="header-anchor">#</a> 文件限制</h4> <p>Worker 线程无法读取本地文件（<code>file://</code>），会拒绝使用 file 协议来创建 Worker实例，它所加载的脚本，必须来自网络。</p> <h4 id="dom-操作限制"><a href="#dom-操作限制" class="header-anchor">#</a> DOM 操作限制</h4> <p>Worker 线程所在的全局对象，与主线程不一样，区别是：</p> <ul><li>无法读取主线程所在网页的 DOM 对象</li> <li>无法使用<code>document</code>、<code>window</code>、<code>parent</code>这些对象</li></ul> <h4 id="通信限制"><a href="#通信限制" class="header-anchor">#</a> 通信限制</h4> <p>Worker 线程和主线程不在同一个上下文环境，它们<strong>不能直接通信</strong>，必须通过消息完成，交互方法是<code>postMessage</code>和<code>onMessage</code>，并且在数据传递的时候， Worker 是使用<strong>拷贝</strong>的方式。</p> <h4 id="脚本限制"><a href="#脚本限制" class="header-anchor">#</a> 脚本限制</h4> <p>Worker 线程不能执行<code>alert()</code>方法和<code>confirm()</code>方法，但可以使用 XMLHttpRequest 对象发出 AJAX 请求，也可以使用<code>setTimeout/setInterval</code>等API</p> <h2 id="使用方式"><a href="#使用方式" class="header-anchor">#</a> 使用方式</h2> <h3 id="基本-api"><a href="#基本-api" class="header-anchor">#</a> 基本 API</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span>aURL<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><code>worker.postMessage</code>: 向 worker 的内部作用域发送一个消息，消息可由任何 JavaScript 对象组成</li> <li><code>worker.terminate</code>: 立即终止 worker。该方法并不会等待 worker 去完成它剩余的操作；worker 将会被立刻停止</li> <li><code>worker.onmessage</code>:当 worker 的父级接收到来自其 worker 的消息时，会在 Worker 对象上触发 message 事件</li> <li><code>worker.onerror</code>: 当 worker 出现运行中错误时，它的 onerror 事件处理函数会被调用。它会收到一个扩展了 ErrorEvent 接口的名为 error 的事件</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>worker<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message<span class="token punctuation">)</span> <span class="token comment">// 可读性良好的错误消息</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>filename<span class="token punctuation">)</span> <span class="token comment">// 发生错误的脚本文件名</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>lineno<span class="token punctuation">)</span> <span class="token comment">// 发生错误时所在脚本文件的行号</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>主要流程为:</p> <ol><li>主线程调用 <code>new Worker(url)</code> 创建 Worker 实例, <code>url</code> 为 Worker JS 资源 url。</li> <li>主线程调用 <code>postMessage</code> 发送消息, 在 <code>onmesssage</code> 中监听 Worker 线程消息。</li> <li>Worker 线程在 <code>onmessage</code> 中监听主线程消息, 收到主线程的消息; 通过 <code>postMessage</code> 回复。</li> <li>主线程在消息回调中收到 Worker 的信息。</li></ol> <p>postMessage 会在接收线程创建一个MessageEvent, 传递的数据添加到 <code>event.data</code>, 再触发该事件; MessageEvent 的回调函数进入 Message Queue, 成为<strong>待执行的宏任务</strong>. 因此 postMessage <strong>顺序发送</strong>的信息, 在接收线程中会<strong>顺序执行回调函数</strong>. 而且我们无需担心实例化 Worker 过程中 postMessage 的信息丢失问题, 对此 Worker 内部机制已经处理.</p> <p>Worker 事件驱动(postMessage/onmessage) 的通信 API 虽然简洁, 但大多数场景下通信需要等待响应(类似 HTTP 请求的 Request 和 Response), 并且多次同类型通信要匹配到各自的响应. 所以业务使用一般会封装原生 API, 如封装为 Promise 调用。</p> <h3 id="直接指定脚本文件"><a href="#直接指定脚本文件" class="header-anchor">#</a> 直接指定脚本文件</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> myWorker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span>aURL<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>aURL</code>表示 worker 将执行的脚本的 URL（脚本文件）， 即 Web Worker 所要执行的任务。案例如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 主线程下创建worker线程</span>
<span class="token keyword">const</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token string">'./worker.js'</span><span class="token punctuation">)</span>

<span class="token comment">// 监听接收worker线程发的消息</span>
worker<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'主线程收到worker线程消息：'</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 向worker线程发送消息</span>
worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'主线程发送hello world'</span><span class="token punctuation">)</span>

<span class="token comment">// worker.js</span>
<span class="token comment">// self 代表子线程自身，即子线程的全局对象</span>
self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// e.data表示主线程发送过来的数据</span>
  self<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">&quot;worker线程收到的：&quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 向主线程发送消息</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>Web Worker 的执行上下文名称是 self，无法调用主线程的 window 对象的。上述写法等同于以下写法：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// e.data表示主线程发送过来的数据</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">&quot;worker线程收到的：&quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 向主线程发送消息</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 将JS文件引入html挂在本地开发环境运行，运行结果如下：</span>
<span class="token comment">// 主线程收到 worker 线程消息： worker 线程收到的：主线程发送 hello world </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="使用-blob-url-创建"><a href="#使用-blob-url-创建" class="header-anchor">#</a> 使用 Blob URL 创建</h3> <p>除了这种通过引入js文件的方式，也可以通过<code>URL.createObjectURL()</code>创建URL对象，创建内嵌的worker</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * const blob = new Blob(array, options);
 * Blob() 构造函数返回一个新的 Blob 对象。blob 的内容由参数数组中给出的值的串联组成。
 * @params array 是一个由ArrayBuffer, ArrayBufferView, Blob, DOMString 等对象构成的 Array
 * @options type，默认值为 &quot;&quot;，它代表了将会被放入到 blob 中的数组内容的 MIME 类型。还有两个这里忽略不列举了
 */</span>
 
<span class="token comment">/**
 * URL.createObjectURL()：静态方法会创建一个 DOMString，其中包含一个表示参数中给出的对象的 URL。这个 URL 的生命周期和创建它的窗口中的 document 绑定。这个新的 URL 对象表示指定的 File 对象或 Blob 对象
 */</span>
<span class="token keyword">const</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">createWorker</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// const blob = new Blob([fn.toString() + ' fn()'], { type: 'text/javascript' })</span>
  <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fn<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)()</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'text/javascript'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">createWorker</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="worker-线程中引入其他脚本"><a href="#worker-线程中引入其他脚本" class="header-anchor">#</a> Worker 线程中引入其他脚本</h3> <p>Worker线程内部要加载其他脚本，可以使用 <code>importScripts()</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// worker.js</span>
<span class="token function">importScripts</span><span class="token punctuation">(</span><span class="token string">&quot;constants.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// self 代表子线程自身，即子线程的全局对象</span>
self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  self<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 可拿到 `foo`、`getAge()`、`getName`的结果值 </span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// constants.js</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token string">&quot;变量&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">25</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">&quot;jacky&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
复制代码
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>还可以同时加载多个脚本</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">importScripts</span><span class="token punctuation">(</span><span class="token string">'script1.js'</span><span class="token punctuation">,</span> <span class="token string">'script2.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Worker 多线程虽然实现了 JS 任务的并行运行, 也带来额外的<strong>通信开销</strong>。在线程计算能力固定的情况下, 要通过多线程提升更多性能, 需要尽量<strong>减少通信消耗</strong>。而且主线程 postMessage 会占用主线程同步执行, <strong>占用时间与数据传输方式和数据规模相关</strong>. 要避免多线程通信导致的主线程卡顿, 需选择合适的传输方式, 并控制每个渲染周期内的数据传输规模。</p> <p><img src="/blog/images/architecture/webworker2.png" alt="webworker2"></p> <h3 id="数据传输方式"><a href="#数据传输方式" class="header-anchor">#</a> 数据传输方式</h3> <p>我们先来聊聊主线程和 Worker 线程的数据传输方式。根据计算机进程模型, 主线程和 Worker 线程属于同一进程, 可以访问和操作进程的内存空间. 但为了降低多线程并发的逻辑复杂度, 部分传输方式直接隔离了线程间的内存, 相当于默认加了锁。通信方式有 3 种:</p> <ul><li>Structured Clone,</li> <li>Transfer Memory</li> <li>Shared Array Buffer.</li></ul> <h4 id="structured-clone"><a href="#structured-clone" class="header-anchor">#</a> Structured Clone</h4> <p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWeb_Workers_API%2FStructured_clone_algorithm" target="_blank" rel="noopener noreferrer">Structured Clone<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 是 postMessage 默认的通信方式。复制一份线程A 的 JS Object 内存给到线程B, 线程B 能获取和操作新复制的内存。</p> <p><img src="/blog/images/architecture/webworker3.png" alt="webworker3"></p> <p>Structured Clone 通过复制内存的方式简单有效地隔离不同线程内存, 避免冲突; 且传输的 Object 数据结构很灵活. 但复制过程中, 线程A 要<strong>同步执行</strong> Object Serialization, 线程B 要<strong>同步执行</strong> Object Deserialization; 如果 Object 规模过大, 会占用大量的线程时间.</p> <h4 id="transfer-memory"><a href="#transfer-memory" class="header-anchor">#</a> Transfer Memory</h4> <p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FTransferable" target="_blank" rel="noopener noreferrer">Transfer Memory<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 意为转移内存, 它不需要 Serialization/Deserialization, 能大大减少传输过程占用的线程时间. 如下图所示 , 线程A 将指定内存的所有权和操作权转给线程B, 但转让后线程A 无法再访问这块内存.</p> <p><img src="/blog/images/architecture/webworker4.png" alt="webworker4"></p> <p>Transfer Memory <strong>以失去控制权来换取高效传输</strong>, 通过内存独占给多线程并发加锁. 但只能转让 <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FArrayBuffer" target="_blank" rel="noopener noreferrer">ArrayBuffer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 等大小规整的二进制(Raw Binary)数据; 对矩阵数据(如 RGB 图片)比较适用. 实践上也要考虑从 JS Object 生成二进制数据的运算成本.</p> <h4 id="shared-array-buffers"><a href="#shared-array-buffers" class="header-anchor">#</a> Shared Array Buffers</h4> <p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FSharedArrayBuffer" target="_blank" rel="noopener noreferrer">Shared Array Buffer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 是共享内存, 线程A 和线程B 可以<strong>同时访问和操作</strong>同一块内存空间. 数据都共享了, 也就没有传输什么事了。</p> <p><img src="/blog/images/architecture/webworker5.png" alt="webworker5"></p> <p>但多个并行的线程共享内存, 会产生竞争问题(Race Conditions). 不像前 2 种传输方式默认加锁, Shared Array Buffers 把难题抛给开发者, 开发者可以用 <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FAtomics" target="_blank" rel="noopener noreferrer">Atomics<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 来维护这块共享的内存. 作为较新的传输方式, 浏览器兼容性可想而知。</p> <h3 id="传输方式小结"><a href="#传输方式小结" class="header-anchor">#</a> 传输方式小结</h3> <ul><li>全浏览器兼容的 Structured Clone 是较好的选择, 但要考虑数据传输规模, 下文我们会详细展开.</li> <li>Transfer Memory 的兼容性也不错(IE11+), 但数据独占和数据类型的限制, 使得它是特定场景的最优解, 不是通用解;</li> <li>Shared Array Buffers 当下糟糕的兼容性和线程锁的开发成本, 建议先暗中观察</li></ul> <p>使用 <code>Structured Clone</code> 传输数据时, 有个阴影一直笼罩着我们: postMessage 前要不要对数据 JSON.stringify 一把, <strong>听说那样更快?</strong></p> <p>相同的数据规模, 直接 postMessage 的传输时间普遍比 <code>JSON.stringify</code> 更少。当下, <strong>不需要再使用 <code>JSON.stringify</code></strong>. 其一是 Structured Clone 内置的 <code>serialize/deserialize</code> 比 <code>JSON.stringify</code> 性能更高; 其二是 <code>JSON.stringify</code> 只适合序列化基本数据类型, 而 Structured Clone 还支持复制其他内置数据类型(如 Map, Blob, RegExp 等, 虽然大部分应用场景只用到基本数据类型)</p> <p><code>Structured Clone</code> 的 <code>serialize/deserialize</code> 执行耗时<strong>主要受数据对象复杂度影响</strong>, 这很好理解, 因为 <code>serialize/deserialize</code> 至少要以某种方式遍历对象. 数据对象的复杂度本身难以度量, 可以用序列化后的数据规模(size)作为参考。</p> <p>总之, 数据传输规模并没有最佳实践. 而是充分理解 Worker postMessage 的传输成本, 在实际应用中, 根据业务场景去评估和控制数据规模。</p> <h2 id="应用场景"><a href="#应用场景" class="header-anchor">#</a> 应用场景</h2> <h3 id="减少卡顿"><a href="#减少卡顿" class="header-anchor">#</a> 减少卡顿</h3> <p>根据 Chrome 团队提出的用户感知性能模型 RAIL, 同步 JS 执行时间不能过长。量化来说, 播放动画时建议小于 16ms, 用户操作响应建议小于 100ms, 页面打开到开始呈现内容建议小于 1000ms。</p> <h3 id="性能提升"><a href="#性能提升" class="header-anchor">#</a> 性能提升</h3> <h5 id="逻辑异步化"><a href="#逻辑异步化" class="header-anchor">#</a> 逻辑异步化</h5> <p>减少主线程卡顿的主要方法为异步化执行, 比如播放动画时, 将同步任务拆分为多个小于 16ms 的子任务, 然后在页面每一帧前通过 requestAnimationFrame 按计划执行一个子任务, 直到全部子任务执行完毕。</p> <p>拆分同步逻辑的异步方案对大部分场景有效果, 但并不是一劳永逸的银弹. 有以下几个问题:</p> <p>不是所有 JS 逻辑都可拆分. 比如数组排序, 树的递归查找, 图像处理算法等, 执行中需要维护当前状态, 且调用上非线性, 无法轻易地拆分为子任务。</p> <p>可以拆分的逻辑难以把控粒度. 拆分的子任务在高性能机器(iphoneX)上可以控制在 16ms 内, 但在性能落后机器(iphone6)上就超过了 deadline. 16ms 的用户感知时间, 并不会因为用户手上机器的差别而变化, Google 给出的建议是再拆小到 3-4ms。</p> <p>拆分的子任务并不稳定. 对同步 JS 逻辑的拆分, 需要根据业务场景寻找原子逻辑, 而原子逻辑会跟随业务变化, 每次改动业务都需要去 review 原子逻辑。</p> <h5 id="worker-一步到位"><a href="#worker-一步到位" class="header-anchor">#</a> Worker 一步到位</h5> <p>Worker 的多线程能力, 使得同步 JS 任务的拆分一步到位: 从宏观上将整个同步 JS 任务异步化. 不需要再去苦苦寻找原子逻辑, 逻辑异步化的设计上也更加简单和可维护。</p> <p>这给我们带来更多的想象空间. 在浏览器主线程渲染周期内, 将可能阻塞页面渲染的 JS 运行任务(Jank Job)迁移到 Worker 线程中, 进而减少主线程的负担, 缩短渲染间隔, 减少页面卡顿。</p> <h5 id="性能提升-2"><a href="#性能提升-2" class="header-anchor">#</a> 性能提升</h5> <p>Worker 多线程并不会直接带来计算性能的提升, 能否提升与设备 CPU 核数和线程策略有关</p> <h3 id="把主线程还给-ui"><a href="#把主线程还给-ui" class="header-anchor">#</a> 把主线程还给 UI</h3> <p>Worker 的应用场景, 本质上是从主线程中剥离逻辑, 让主线程专注于 UI 渲染. 这种架构设计并非 Web 技术上的独创。</p> <p>Android 和 iOS 的原生开发中, <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Ftopic%2Fperformance%2Fthreads" target="_blank" rel="noopener noreferrer">主线程负责 UI 工作<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>; 前端领域热门的小程序, 实现原理上就是<a href="https://link.juejin.cn?target=https%3A%2F%2Fwechat-miniprogram.github.io%2Fkbone%2Fdocs%2Fguide%2Fprinciple.html" target="_blank" rel="noopener noreferrer">渲染和逻辑的完全分离<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p><a href="https://mp.weixin.qq.com/s/JdG-FP04s0gUnN8dWcxFgg" target="_blank" rel="noopener noreferrer">Service Worker 实践指南<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mp.weixin.qq.com/s/WP2RT6VBPtD5bpq3WaEpeQ" target="_blank" rel="noopener noreferrer">Web Worker 现状<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.cn/post/6854573213297410062#heading-16" target="_blank" rel="noopener noreferrer">Web Worker 文献综述<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mp.weixin.qq.com/s/SCFk6FgtKQ8N-VrV6OmioA" target="_blank" rel="noopener noreferrer">一文搞懂 Web Worker(原理到实践)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.cn/post/7176788060619669565#heading-16" target="_blank" rel="noopener noreferrer">梳理 Web Worker 及实战场景<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.cn/post/6948752328715403300#heading-2" target="_blank" rel="noopener noreferrer">浅探 Web Worker 与 JavaScript 沙箱<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mp.weixin.qq.com/s/Bm-TI9K8Za8Ret22WucOFA" target="_blank" rel="noopener noreferrer">一文彻底了解Web Worker，十万、百万条数据<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mp.weixin.qq.com/s/eX2dFf999GleZiarpKbdoA" target="_blank" rel="noopener noreferrer">将 useReducer 应用于 Web Worker<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mp.weixin.qq.com/s/ZK5tk1I4fZZ4SEETNtMsVA" target="_blank" rel="noopener noreferrer">换一种风格理解 Chrome 浏览器渲染全过程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/mobile/h5/mobile-fit.html" class="prev">
        H5 移动端适配
      </a></span> <span class="next"><a href="/blog/mobile/h5/rn.html">
        RN 新架构
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----><!----></div></div>
    <script src="/blog/assets/js/app.f064466e.js" defer></script><script src="/blog/assets/js/2.dec2e75d.js" defer></script><script src="/blog/assets/js/1.5b9e135c.js" defer></script><script src="/blog/assets/js/135.55b14adc.js" defer></script><script src="/blog/assets/js/20.badbb211.js" defer></script>
  </body>
</html>
