(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{513:function(s,a,t){"use strict";t.r(a);var e=t(14),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"webpack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#webpack"}},[s._v("#")]),s._v(" webpack")]),s._v(" "),t("p",[s._v("webpack实践")]),s._v(" "),t("ul",[t("li",[s._v("webpack核心概念："),t("code",[s._v("entry")]),s._v(","),t("code",[s._v("output")]),s._v(","),t("code",[s._v("loaders")]),s._v(","),t("code",[s._v("plugins")]),s._v(","),t("code",[s._v("mode")]),s._v(" 等")]),s._v(" "),t("li",[s._v("解析ES6，CSS，Less，Scss，stylus")]),s._v(" "),t("li",[s._v("解析图片和字体")]),s._v(" "),t("li",[s._v("webpack文件监听")]),s._v(" "),t("li",[s._v("webpack的热更新及原理")]),s._v(" "),t("li",[s._v("代码压缩")]),s._v(" "),t("li",[s._v("自动清理构建目录产物")]),s._v(" "),t("li",[s._v("postcss插件 autoprefixer 自动补齐css前缀")]),s._v(" "),t("li",[s._v("移动端css的px自动转换为rem")]),s._v(" "),t("li",[s._v("静态资源内联")]),s._v(" "),t("li",[s._v("多页面打包通用方案")]),s._v(" "),t("li",[s._v("使用sourceMap")]),s._v(" "),t("li",[s._v("提取页面公共资源")]),s._v(" "),t("li",[s._v("Tree Shaking摇树优化")]),s._v(" "),t("li",[s._v("Scope Hoisting 的使用和原理")]),s._v(" "),t("li",[s._v("代码分割及动态import")]),s._v(" "),t("li",[s._v("在webpack中使用ESLint")]),s._v(" "),t("li",[s._v("webpack实现SSR打包")]),s._v(" "),t("li",[s._v("prerender 渲染骨架屏")]),s._v(" "),t("li",[s._v("webpack打包组件和基础库")]),s._v(" "),t("li",[s._v("如何分析页面打包问题")]),s._v(" "),t("li",[s._v("初级分析 使用 webpack 内置 stats")]),s._v(" "),t("li",[s._v("速度分析 使用 speed-measure-webpack-plugin")]),s._v(" "),t("li",[s._v("体积分析 使用 webpack-bundle-analyzer")]),s._v(" "),t("li",[s._v("多进程 多实例构建")]),s._v(" "),t("li",[s._v("多进程并行压缩代码")]),s._v(" "),t("li",[s._v("进一步分包：预编译资源模块")]),s._v(" "),t("li",[s._v("充分利用缓存提升二次构建速度")]),s._v(" "),t("li",[s._v("使用动态 ployfill 服务")]),s._v(" "),t("li",[s._v("webpack 的本质与 Tapable")]),s._v(" "),t("li",[s._v("webpack事件流")]),s._v(" "),t("li",[s._v("compile 和 compilation 对象")]),s._v(" "),t("li",[s._v("webapck 入口文件")]),s._v(" "),t("li",[s._v("webpack 参数传递与编译启动")]),s._v(" "),t("li",[s._v("编译与构建主流程")]),s._v(" "),t("li",[s._v("loader的执行顺序")]),s._v(" "),t("li",[s._v("loader匹配文件的可选方式")]),s._v(" "),t("li",[s._v("编写loader")]),s._v(" "),t("li",[s._v("webpack plugin 的 API")]),s._v(" "),t("li",[s._v("编写webpack 的 插件")])]),s._v(" "),t("h2",{attrs:{id:"构建包大小的诱因"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建包大小的诱因"}},[s._v("#")]),s._v(" 构建包大小的诱因")]),s._v(" "),t("p",[s._v("在做优化工作前，我们首先要知道是我们要针对什么做优化。为此，我们要通过 webpack-bundle-analyzer 插件。\n它能提供可视化指南分析构建包中文件的大小。")]),s._v(" "),t("blockquote",[t("p",[s._v("npm install --save-dev webpack-bundle-analyzer")])]),s._v(" "),t("p",[s._v("在 vue.config.js 文件中配置：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" BundleAnalyzerPlugin "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'webpack-bundle-analyzer'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BundleAnalyzerPlugin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmodule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    configureWebpack"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    plugins"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BundleAnalyzerPlugin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("下面举几个在项目中遇到的：")]),s._v(" "),t("h3",{attrs:{id:"减少-lodash-的大小"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#减少-lodash-的大小"}},[s._v("#")]),s._v(" 减少 Lodash 的大小")]),s._v(" "),t("p",[s._v("我经常在项目中使用lodash这个js工具库，它提供了许多友好的工具函数，同时也是vue官方推荐的。")]),s._v(" "),t("p",[s._v("通常loadsh会占用许多空间，那么针对它做一些优化是必要的。在项目中加载整个库是得不偿失的，我们应该按需加载。\n就像这样：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" sortBy"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("forEach"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("filters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("finds"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("cloneDeep"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("isEmpty "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lodash/core'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("而不是这样：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" _ "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lodash'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"减少-moment-js-的大小"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#减少-moment-js-的大小"}},[s._v("#")]),s._v(" 减少 moment.js 的大小")]),s._v(" "),t("p",[s._v("我们也经常使用moment这个js库来处理有关时间/日期的逻辑。虽然它没有lodash那样占用很多空间，但是我们通常\n也不会用到它的所有功能，比如许多国际化语言包。如果只用到日期的操作可以这样")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" moment "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'moment/src/moment'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("而不是这样：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" moment "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'moment'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("但是更好的做法是在 webpack 中创建一个快捷方式别名。该快捷方式将用'moment/src/moment'替换所有导入'moment'的调用。\n我们可以使用 resolve 在我们的 vue.config.js 文件中添加该别名并进行设置。")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" BundleAnalyzerPlugin "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'webpack-bundle-analyzer'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BundleAnalyzerPlugin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmodule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    configureWebpack"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    plugins"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BundleAnalyzerPlugin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    resolve"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      alias"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        moment"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'moment/src/moment'")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("删除 moment.js 中的语言环境后，每当我启动服务器运行我的代码时都会发生错误，说它无法找到./locale。\n经过一些研究我发现这是 moment.js 的一个存在多年的已知问题：moment.js 总是会加载 locales，\n还假定 locales 存在。你不能让 moment 只加载日期操作函数。")]),s._v(" "),t("p",[s._v("为了解决这个问题，我使用内置的 webpack IgnorePlugin 忽略了这个消息。\n下面是我添加到 vue.config.js 文件中的插件代码：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("webpack"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("IgnorePlugin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("^\\.\\/locale$")]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("moment$")]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"webpack进阶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#webpack进阶"}},[s._v("#")]),s._v(" webpack进阶")]),s._v(" "),t("ul",[t("li",[s._v("有哪些常见的 loader？他们能解决什么问题？")]),s._v(" "),t("li",[s._v("webpack 的构建流程是什么? 从读取配置到输出文件的整个过程")]),s._v(" "),t("li",[s._v("是否写过 loader 和 Plugin ？描述一下编写 loader 或 Plugin 的思路？")]),s._v(" "),t("li",[s._v("webpack 的热更新是如何做到的？说明其原理？")]),s._v(" "),t("li",[s._v("如何利用 webpack 来优化前端性能？（提高性能和体验）")])]),s._v(" "),t("p",[s._v("在掌握 webpack 打包的速度、体积，及页面加载时的性能优化之前，\n你需要先搞懂 webpack 内部的运行原理和插件机制。")])])}),[],!1,null,null,null);a.default=n.exports}}]);